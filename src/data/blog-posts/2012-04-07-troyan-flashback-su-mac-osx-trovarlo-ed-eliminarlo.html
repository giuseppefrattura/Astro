---
layout: post
status: publish
published: true
title: Troyan FlashBack su Mac OsX Trovarlo ed eliminarlo
date: '2012-04-07 10:29:43 +0200'
categories:
- Varie
tags:
- Mac
- Apple
- Flashback
- Malware
- Troyan
comments: []
---
<p>Pare che negli ultimi mesi un Troyan di nome FlashBack sia riuscito ad infettare circa 600mila Mac tra portatili e fissi. Gli utenti Apple non sono mai stati propensi all&rsquo;utilizzo di antivirus perch&eacute; non c&rsquo;&egrave; n&rsquo;&egrave; mai stato un grande bisogno, eppure con l&rsquo;aumento di vendite dei Mac stanno nascendo sempre pi&ugrave; malware per questo tipo di computer.</p>
<!--more-->
<img class="img-fluid"  title="come-proteggersi-dalle-nuove-insidie-del-cavallo-di-troia-su-mac-flashback-malware" alt="" src="{{ site.url }}/assets/come-proteggersi-dalle-nuove-insidie-del-cavallo-di-troia-su-mac-flashback-malware.jpg" width="100%" />

<p>Il Troyan in questione sfrutta un bug nella macchina virtuale di Java per entrare nel sistema, una sua versione precedente usava un aggiornamento di Flash, un applicativo grafico molto usato, soprattutto dagli amanti della mela.</p>
<p>Per verificare se si &egrave; stati infettati si pu&ograve; aprire il terminale di Mac OsX, Applicazioni->Utility->Terminale, indipendentemente dalla versione, Leopard, Snow Leopard o Lion ed eseguire il seguente comando:</p>
<p>ls /Users/Shared/.*.so</p>
<p>se vedrete il risultato &ldquo;No such file or directory&rdquo;, vuol dire che non siete stati infettati, nel caso in cui vediate un elenco di files che finiscono per &ldquo;.so&rdquo; vuol dire che siete stati infettati.</p>
<p>Se siete stati infettati nessuna paura, i metodi per liberarsi del Troyan sono essenzialmente due.</p>
<img class="img-fluid"  class="alignnone size-medium wp-image-535" title="apple-cura-i-malware" alt="" src="{{ site.url }}/assets/apple-cura-i-malware.jpg" width="100%" />
<h3>Metodo semplice</h3>
<p>Scaricate un antivirus per Mac per effettuarne la rimozione, uno di quelli consigliato &egrave; <a title="Intego" href="http://www.intego.com/" target="_blank">Intego</a>&nbsp;oppure <a title="F-Secure" href="http://www.f-secure.com/it/web/home_it/protection/anti-virus-for-mac/overview" target="_blank">F-Secure</a>.</p>

<h3>Metodo Complicato</h3>
<p>
<strong>1</strong> - Aprire il terminale e digitare &ldquo;defaults read /Applications/Safari.app/Contents/Info LSEnvironment&rdquo;<br />
<strong>2</strong> - Prendere nota dei codici DYLD_INSERT_LIBRARIES e premere nuovamente invio<br />
<strong>3</strong> - Se si riceve un messaggio d&rsquo;errore simile a &ldquo;The domain/default pair of (/Applications/Safari.app/Contents/Info, LSEnvironment) does not exist&rdquo; non si &egrave; infetti.<br />
<strong>4</strong> - Se i file vengono effettivamente trovati, digitare &ldquo;grep -a -o &lsquo;__ldpath__[ -~]*&rsquo; %percorso_del_punto_2% &rdquo; e prendere nota del valore di fianco a &ldquo;__ldpath__&rdquo;<br />
<strong>5</strong> - Eseguire i comandi &ldquo;sudo defaults delete /Applications/Safari.app/Contents/Info LSEnvironment&rdquo; e &ldquo;sudo chmod 644 /Applications/Safari.app/Contents/Info.plist&rdquo;, cancellando poi i file trovati nel secondo punto e nel quarto.<br />
<strong>6</strong> - Eseguire il comando &ldquo;defaults read ~/.MacOSX/environment DYLD_INSERT_LIBRARIES&rdquo; e, se si riceve un messaggio come &ldquo;The domain/default pair of (/Users/joe/.MacOSX/environment, DYLD_INSERT_LIBRARIES) does not exist&rdquo; il trojan &egrave; stato correttamente rimosso. In caso contrario, eseguire nuovamente &ldquo;grep -a -o &lsquo;__ldpath__[ -~]*&rsquo; %percorso_del_punto 4% &ldquo;, prendendo nota dei valori.<br />
<strong>7</strong> - Dopo aver eseguito &ldquo;defaults delete ~/.MacOSX/environment DYLD_INSERT_LIBRARIES launchctl unsetenv DYLD_INSERT_LIBRARIES&rdquo;, cancellare i file indicati nei punti precedenti.</p>
<p>Fonte <a title="La Repubblica" href="http://www.repubblica.it/tecnologia/2012/04/05/news/un_worm_infetta_600mila_mac_ecco_come_rimuovere_il_virus-32811422/" target="_blank">La Repubblica</a></p>
<p>Il primo metodo &egrave; semplice ma ha un costo di circa 40&euro; che garantisce per&ograve; l&rsquo;utilizzo di un antivirus per un anno, e quindi potrebbe difendervi da altri malware, il secondo metodo &egrave; sicuramente pi&ugrave; complesso, ma vi consente senza spese di curare il vostro Mac.</p>
<p>La Apple ha gi&agrave; provveduto a rilasciare ben due&nbsp; aggiornamenti per la macchina virtuale Java, a chi non &egrave; stato ancora colpito dal malware conviene effettuare tutti gli aggiornamenti, per gli utenti gi&agrave; infettati sono inutili, dovrenno prima rimuovere il malware dal proprio mac e poi aggiornare.</p>
<h3>Curiosit&agrave;</h3>
<p>Che significa ls /Users/Shared/.*.so ?</p>
<p>Si &egrave; scoperto che FlashBack crea dei file all&rsquo;interno della cartella /Users/Shared/ che finiscono con &ldquo;.so&rdquo;. Per cercare quindi la presenza di files di questo tipo usiamo il comando <strong>ls</strong> che serve ad elencare l&rsquo;elenco dei files all&rsquo;interno di una cartella, in questo caso /Users/Shared/ e poi usiamo le <strong>espressioni regolari</strong>. L&rsquo;espressione regolare che usiamo in questo caso &egrave; composta da due parti &ldquo;.*&rdquo; e &ldquo;.so&rdquo;.</p>
<p>&ldquo;.*&ldquo; identifica un insieme di caratteri, qualsiasi carattere indipendentemente dalle volte in cui si presenta.</p>
<p>&ldquo;.so&rdquo; invece denota che il nome del fine finisce con &lsquo;.so&rsquo; .</p>
